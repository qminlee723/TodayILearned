# 4장. 변수

## 4.1 변수란 무엇인가? 왜 필요한가?

### 메모리에 대한 이해

- 메모리는 데이터를 저장할 수 있는 메모리 셀의 집합체
  - 메모리 셀 하나의 크기는 1바이트(8비트)
  - 컴퓨터는 1바이트 단위로 데이터를 저장하거나 읽어들임
- 각 메모리 셀은 메모리 주소를 가짐
  - 메모리 주소란 메모리 공간의 위치이며, 0부터 시작해서 메모리의 크기만큼 정수로 표현됨



- 어떠한 연산을 했을 때, 해당 연산 결과를 재사용하고 싶다면 메모리 주소를 통해 연산 결과가 저장된 메모리 공간에 직접 접근해야 함
- 하지만, **메모리 주소를 통해 값에 직접 접근하는 것은 치명적 오류를 발생시킬 가능성이 높다**
  - 따라서 자바스크립트는 개발자의 직접적인 메모리 제어를 허용하지 않음
  - 제어를 허용한다고 해도, 값이 저장될 메모리 주소는 코드가 실행될 때 메모리의 상황에 따라 임의로 결정됨. 따라서 동일한 컴퓨터에서 동일한 코드를 실행해도 코드가 실행될 때 마다 값이 저장될 메모리 주소는 변경됨
- 따라서 프로그래밍 언어는 기억하고 싶은 값을 메모리에 저장하고, 저장된 값을 읽어들여 재사용하기 위한 변수라는 매커니즘을 제공함



### 변수

- 변수는 **하나의 값을 저장하기 위해 확보한 메모리 공간 자체** 또는 그 메모리 공간을 식별하기 위해 붙인 이름
  - 배열이나 객체 같은 자료구조를 사용하면 관련 있는 여러 개의 값을 그룹화 해 하나의 값처럼 사용 가능
- 값을 저장하고 참조하는 매커니즘으로, **값의 위치를 가리키는 상징적인 이름**
  - 프로그래밍 언어의 컴파일러 또는 인터프리터에 의해 값이 저장된 메모리 공간의 주소로 치환되어 실행
  - 따라서 개발자가 직접 메모리 주소를 통해 값을 저장하고 참조할 필요가 없고, 변수를 통해 안전하게 값에 접근할 수 있음
- 변수에 값을 저장하는 것을 할당(assignment)이라고 하고, 변수에 저장된 값을 읽어 들이는 것을 참조라고 함
  - 변수 이름을 사용해 참조를 요청하면 자바스크립트 엔진은 **변수 이름과 매핑된 메모리 주소를 통해 메모리 공간에 접근**해서 저장된 값을 반환
- 변수에 저장된 값의 의미를 파악할 수 있는 변수 이름은 가독성을 높이는 부수적 효과도 있음



## 4.2 식별자(identifier)

- 어떤 값을 구별해서 식별할 수 있는 고유한 이름
- 식별자는 값이 아니라 메모리 주소를 기억하는 것 
  - 값은 메모리 공간에 저장되어 있고, 식별자는 메모리 공간에 저장되어 있는 어떤 값을 구별해서 식별해 낼 수 있어야 함. 따라서 식별자는 어떤 값이 저장되어 있는 **메모리 주소를 기억**해야 함.
  - 식별자로 값을 구별해서 식별한다는 것은 식별자가 기억하고 있는 메모리 주소를 통해 메모리 공간에 저장된 값에 접근할 수 있다는 의미
  - 즉, 식별자는 메모리 주소에 붙인 이름
- 변수, 함수, 클래스 모두 식별자가 될 수 있다
  - 변수는 식별자지만, 식별자는 변수가 아닐 수도 있다
- 식별자는 네이밍 규칙을 준수해야 하며, 선언에 의해 자바스크립트 엔진에 식별자의 존재를 알림

## 4.3 변수 선언(variable declaration)

-  변수를 생성하는 것
- 값을 저장하기 위한 메모리 공간을 확보하고, 변수 이름과 확보된 메모리 공간의 주소를 연결(name binding)해서 값을 저장할 수 있게 준비하는 것
- 변수를 사용하려면 반드시 선언이 필요하다. 
  - `var`, `let`, `const` 키워드 사용
  - `var`의 단점
    - 블록 레벨 스코프를 지원하지 않고, 함수 레벨 스코프를 지원하여 의도치 않게 전역 변수가 선언되어 심각한 부작용이 발생
    - 따라서 `let`, `const` 사용을 권장



- `var`를 사용해 변수를 선언하면, 해당 변수에는 `undefined`가 할당되어 초기화된다
  - undefined란 자바스크립트에서 제공하는 원시값(primitive value)
- 자바스크립트 엔진은 변수 선언을 다음과 같은 2단계에 거쳐 수행한다
  - 선언 단계: 변수 이름을 등록해서 자바스크립트 엔진에 변수의 존재를 알림
  - 초기화 단계: 값을 저장하기 위한 메모리 공간을 확보하기 암묵적으로 undefined를 할당해 초기화
- 모든 식별자는 실행 컨텍스트에 등록된다
  - 실행 컨텍스트는 자바스크립트 엔진이 소스코드를 평가하고 실행하기 위해 필요한 **환경**을 제공하고, 코드의 **실행 결과를 실제로 관리**하는 영역
  - 변수 이름과 변수 값은 실행 컨텍스트 내에 키-밸류 형태인 **객체로 등록**되어 관리됨

- `var`키워드를 사용한 변수 선언은 선언 단계와 초기화 단계가 동시에 진행
  - 만약 초기화 단계를 거치지 않으면, 확보된 메모리 공간에는 쓰레기 값(garbage value)이 남아 있을 수 있다. 
  - 따라서 var 키워드는 암묵적으로 초기화를 수행하므로 이러한 위험으로부터 안전
- 선언하지 않은 식별자에 접근하면 `Reference Error`



## 4.4 변수 선언 실행 시점과 변수 호이스팅

```javascript
console.log(score)

var score;
```

- 변수의 선언이 변수 참조 코드보다 뒤에 있어도 Reference Error가 발생하지 않음
- 변수 선언이 런타임 이전 단계에서 먼저 실행되기 때문
  - 런타임: 소스코드가 한 줄 씩 순차적으로 실행되는 시점
- 자바스크립트 엔진은 런타임 이전에 먼저 소스코드의 평가 과정을 거침
  - 이 과정에서 자바스크립트 엔진은 모든 선언문을 소스코드에서 찾아내 먼저 실행
  - 소스코드 평가 과정이 끝나면 변수 선언을 포함한 모든 선언문을 제외하고 소스코드를 한 줄씩 순차적으로 실행
  - 즉, 자바스크립트 엔진은 변수 선언문을 다른 코드보다 먼저 실행
- 이처럼 변수 선언문이 코드의 선두로 끌어 올려진 것처럼 동작하는 자바스크립트 고유 특징을 **변수 호이스팅**이라고 함



## 4.5 값의 할당

변수에 값을 할당할 때는 할당 연산자 `=` 를 사용

```javascript
var score;
score = 80;
```

```javascript
var score = 80;
```

- 정확히 동일하게 동작
  - 변수 선언과 값의 할당을 하나로 단축 표현해도, 변수 선언과 값의 할당을 2개의 문으로 나누어 각각 실행
- 변수 선언은 런타임 이전에 먼저 실행되지만, 값의 할당은 런타임에 실행된다

```javascript
console.log(score); // undefined
var score = 80; // 80
console.log(score); // 80
```

```javascript
console.log(score); // undefined
score = 80; // 2. 값의 할당
var score; // 1. 변수 선언
console.log(score); // 80
```



## 4.6 값의 재할당

- 이미 값이 할당되어 있는 변수에 새로운 값을 또다시 할당하는 것
  - 값을 재할당하면 이전 값을 지우고 새 값을 새롭게 저장하는 것이 아니라, 새로운 메모리 공간을 확보하고 그 메모리 공간에 새 값을 저장
  - 변수의 이전 값인 undefined와 그 전 값은 어떤 식별자와도 연결되어 있지 않다 
  - 가비지 콜렉터에 의해 메모리에서 자동 해제됨
    - 단, 메모리에서 언제 해제될지는 예측할 수 없음
    - 가비지콜렉터: 애플리케이션이 할당한 메모리 공간을 주기적으로 검사하여 더 이상 사용되지 않는 메모리를 헤제하는 기능(어떤 식별자도 참조하지 않는 메모리 공간)
    - 자바스크립트는 가비지 콜렉터를 내장하고 있는 managed 언어
      - unmanaged 언어(ex-C)는 개발자가 메모리 제어를 직접 함
- 값을 재할당 할 수 없어 변수에 저장된 값을 변경할 수 없다면, 변수가 아니라 상수
  - 즉, 한 번만 할당할 수 있는 변수 `const`



## 4.7 식별자 네이밍 규칙

### 네이밍 규칙

- 특수문자를 제외한 문자, 숫자, 언더스코어, 달러 기호 포함 가능
- 식별자는 특수문자를 제외한 문자, 언더스코어, 달러기호로 시작해야 함
  - 즉, 숫자로 시작할 수 없다
- 예약어는 식별자로 사용할 수 없다
  - 프로그래밍 언어에서 사용되고 있거나 사용될 예정인 단어
- 알파벳 외 한글이나 일본어 식별자도 사용할 수는 있지만, 권장하지 않음
- 대소문자를 구분함
- 변수 선언에 별도의 주석이 필요하다면, 변수의 존재 목적을 명확히 드러내지 못하는 것



- 자바스크립트의 예약어

  | await, break, case, catch, class, const, continue, debugger, default, delete, do, else, enum, export, extends, false, finally, for, function, if, implements, import, in, instanceof, interface, let, new, null, package*, private*, protected, public, return, super, static, switch, this, throw, true, try, typeof, var, void, while, with, yield |
  | ------------------------------------------------------------ |

  

### 네이밍 컨벤션

- 카멜 케이스

  ```javascript
  var firstName;
  ```

- 스네이크 케이스

  ```javascript
  var first_name
  ```

- 파스칼 케이스

  ```javascript
  var FirstName;
  ```

- 헝가리언 케이스

  ```javascript
  var strFirstName; // type + identifier
  var $elem = document.getElementById('myId'); // DOM node
  var observable$ = fromEvent(document, 'click'); // RxJS 옵저버블
  ```



- 일반적으로 변수나, 함수의 이름에는 카멜 케이스
- 생성자 함수, 클래스의 이름에는 파스칼 케이스