# 3강. 셸 사용하기

## 01. 셀 개요

### 셸(Shell)

- 명령어 해석기 또는 명령 행 인터페이스

  - 사용자와 커널 사이에서 명령어를 해석해 처리
  - 셸 명령을 사용하면 GUI로는 하기 힘든 다양한 기능을 수행할 수 있음

- 셸 명령을 프로그램으로 작성하여 처리할 수도 있음

  - 셸 스크립트는 텍스트 파일로, 프로그래밍을 통한 셸 명령의 조합(교재 11장)
  - 반복적으로 수행되는 작업을 셸 스크립트로 작성할 수 있음
  - 셸이 셸 스크립트 파일을 읽어 처리할 수 있음

- 텍스트 모드로 로그인을 하면 기본 셸이 주어짐

  

### 셸 사용하기

- 텍스트 모드에서 로그인하면 자동으로 '로그인 셸'이 실행됨
- GNOME 데스크톱에서는 '터미널 창'을 실행시켜 셸을 사용함
  - 현재활동 > 터미널
  - 여러 터미널 창을 띄워 사용할 수 있음
  - 터미널 창은 명령 프롬프트와 명령 행을 제공
- 기본적으로 한 개의 명령을 입력하고 엔터를 눌러 명령을 수행함
  - 결과가 출력되면 명령 프롬프트가 다시 등장함
  - 세미콜론(;)을 사용하면 한 라인에 여러 명령을 입력할 수 있음
- 단축키 `alt` + `f2`



### 셸의 종류

- 많은 리눅스 배포판에서 Bash를 기본 셸로 사용함
  - 명령 프롬프트로 일반 사용자는 $, root 사용자는 #을 사용함
- 셸의 종류에 따라 에일리어스 설정, 초기화 파일, 셸 스크립트 작성법, 명령 행 완성 기능, 명령 행 편집 기능 등에 차이가 있음



### Bash 셸

- Bourne Again Shell로 Bourne 셸의 개선된 버전
  - 많은 셸 스크립트의 문법이 Bourne 셸에 기반을 둠
- C 셸과 Korn 셸의 유용한 기능을 가져옴
- 실행 명령은 `/bin/bash`
  - /etc/passwd 파일에 다음과 같은 라인이 있음
  - qminlee\:x:1000:1000:Gyumin Lee:/home/username:/bin/bash
    - (username) : (password) : (UID: UserID) : (GID: Group ID) : (사용자설명) : /home/username : `/bin/bash`



### 셸 선택하기

- 기본 셸을 변경할 수 있음
  - `chsh -s /bin/sh`
- 터미널 창을 대화형 셸 이라고도 함
  - 셸을 종료하려면 exit 명령 또는 ctrl+d를 실행
  - 로그인 셸이 아님
- 로그인 셸과 비로그인 셸 구분 중요!
  - logout 명령은 로그인 셸에서만 가능하다
  - `ctrl` +`alt` + `f1 ~ f6`으로 가상 콘솔을 사용할 수 있음
  - 셸 프롬프트에서 셸 프로그램을 실행하면 '서브 셸'이 실행됨



## 02. 셸 명령

### 셸 명령의 형식

- $명령어 옵션 인수
  - User mod -L gmlee
  - 옵션과 인수는 여럿일 수 있으며, 선택적 또는 필수적
- 대개 명령어는 프로그램 이름
- 관리자 명령 또는 일반 사용자 명령이 있음
- 가장 간단한 형태의 실행은 명령의 이름만 사용하는 것
  - who, date, ls, pwd



### `chsh` 명령

- 기본 셸을 바꾸는 명령
- `chsh` [*options*]` `[*username*]
  - 대괄호는 생략 가능, 이탤릭체는 적당한 내용으로 대체해야 함을 의미
  - 복수는 여러 개가 가능하다는 의미



### 옵션과 인수

- 짧은 옵션
  - ls -l
  - ls -lat == ls -l-a-t
- 긴 옵션(GNU 스타일)
  - ls --all
- 대쉬가 붙지 않는 옵션도 있음(BSD 스타일)
  - ps a
- 인수는 명령의 수행 대상을 지정하는 것
  - cat -n /etc/passwd
  - grep "Gyumin Lee" /etc/passwd
- 옵션도 인수를 가질 수 있음
  - chsh -s /bin/sh qminlee == Cash --shell=/bin/bash qminlee



### 명령어의 종류

<img src="./assets/Screenshot 2024-10-09 at 7.14.05 PM.png" alt="Screenshot 2024-10-09 at 7.14.05 PM" style="zoom:33%;" />

- 환경변수 PATH에 설정된 경로 중에 실행 파일이 존재하면 명령의 이름만으로 실행이 가능
  - 아니면 해당 실행 파일의 절대 경로를 사용해야 함
  - 현재 디렉터리(.)는 보통 PATH에 포함되어 있지 않음
  - echo $PATH로 저장된 경로를 확인할 수 있음



### alias 명령

- 자주 사용되는 명령의 단축 명령을 만드는 명령
  - alias
  - alias la='ls -A'
    - 숨김 파일까지 포함해서 출력
  - alias rm='rm -i'
    - remove interactive
- 계속 유지하려면, 셸의 환경 설정 파일에 기록해 두어야 함



### type 명령

- 명령이 어떻게 해석되는지 알려주는 명령
  - type cd
  - type -a ls



### which 명령

- 실행 프로그램을 환경변수 PATH를 기초로 찾아 경로를 출력함
  - Which rm



### whereis 명령

- 실행파일 외 소스 프로그램 및 매뉴얼 페이지까지 찾아줌



### man 명령

<img src="./assets/Screenshot 2024-10-09 at 7.21.20 PM.png" alt="Screenshot 2024-10-09 at 7.21.20 PM" style="zoom:50%;" />

- 매뉴얼 페이지를 보여주는 명령

  - 명령어 사용법이나 설정 파일 등에 관한 온라인 도움말을 제공
  - man passwd 또는 man 5 passwd
  - 명령어의 간단한 도움말을 보려면 명령 --help를 사용할 수 있음

  

## 03. 명령 히스토리

### history 명령

- 이전에 수행했던 명령 행의 목록을 불러옴
  - history
  - history 10
    - 10개의 명령행이 출력됨



### 히스토리 기능을 이용해 명령을 실행하는 방법

- 이전에 수행했던 명령을 이요해 명령을 수행할 수 있음
- 다음을 입력하고 실행함

<img src="./assets/Screenshot 2024-10-09 at 7.22.15 PM.png" alt="Screenshot 2024-10-09 at 7.22.15 PM" style="zoom:50%;" />



### 명령 행 완성 기능

- 일부만 입력하고 나머지를 자동으로 완성하는 기능

- 처음 몇 자만 입력하고 tab 키를 누르면 실행됨

  - 명령어, 변수($), 파일, 디렉터리(~ 또는 -) 등을 구분해 결정함
  - ~username은 해당 사용자의 홈 디렉터리를 의미

  <img src="./assets/Screenshot 2024-10-09 at 7.24.33 PM.png" alt="Screenshot 2024-10-09 at 7.24.33 PM" style="zoom:50%;" />

- 정보가 충분하지 않은 경우, tab 키를 한번 더 누르면, 모든 가능한 경우를 보여주고 원래의 명령 행이 유지됨



## 04. 명령의 연결과 확장

### 특수문자(1)

- 셸에서 특별한 의미를 가지는 문자

<img src="./assets/Screenshot 2024-10-09 at 7.25.21 PM.png" alt="Screenshot 2024-10-09 at 7.25.21 PM" style="zoom:50%;" />

<img src="./assets/Screenshot 2024-10-09 at 7.26.31 PM.png" alt="Screenshot 2024-10-09 at 7.26.31 PM" style="zoom:50%;" />



### 파이프

- 앞 명령의 출력 결과를 다음 명령의 입력으로 연결
- 명령1 | 명령2
  - cat /etc/passwd | sort | more



### 입출력 리다이렉션

- 명령 < 파일
  - 명령 수행에 필요한 **입력**을 표준 입력 대신에 파일로부터 얻음
  - Sort < /etc/passwd
- 명령 > 파일
  - 명령의 수행의 결과를 표준 **출력**으로 보내지 않고 파일에 기록함
  - grepa typedef /usr/include/* > typedef.out
- 명령 2> 파일
  - 명령 수행 중 표준 **오류 출력**을 파일에 덧붙임
  - ls 2>> error.txt



### 명령 치환

- 명령을 수행할 때, 명령의 인수로서 다른 명령의 결과를 사용

- $(command) 또는 \`command`

  - 역따옴표(\` `) 사용

  <img src="./assets/Screenshot 2024-10-09 at 7.31.31 PM.png" alt="Screenshot 2024-10-09 at 7.31.31 PM" style="zoom:50%;" />



### 인용부호

<img src="./assets/Screenshot 2024-10-09 at 7.34.17 PM.png" alt="Screenshot 2024-10-09 at 7.34.17 PM" style="zoom:50%;" />

- 빈칸을 포함하는 문자열을 1개의 인수로 사용할 때 인용 부호가 필요함
- 작은따옴표(' ')는 특수문자의 의미를 제거함
- 큰따옴표(" ")는 $, \` `, \, !를 해석하여 확장함
- 백슬래시(\\)는 $, \` `, \ 앞에서 특수 문자의 의미를 제거함



### 수식과 변수의 확장

<img src="./assets/Screenshot 2024-10-09 at 7.36.44 PM.png" alt="Screenshot 2024-10-09 at 7.36.44 PM" style="zoom:50%;" />

- 명령 수행 전에 수식의 결과를 계산하여 전달
  - $[수식] 또는 $((수식))
- 명령 수행 전에 변수의 값을 추출하여 전달
  - $변수



## 05. 셸 변수

### 셸 변수와 환경 변수(1)

- 변수는 특정 데이터 또는 환경 설정을 위한 값을 저장

  - 기본적으로 문자열 정보를 저장함

- 셸 변수(지역 변수)

  - 변수가 정의된 셸에서만 사용이 가능하고, 서브 셸로는 전달되지 않음

  ```shell
  $NAME="KIM"
  $echo $NAME
  KIM
  ```

- 환경 변수(전역 변수)

  - 현재 셸 뿐만 아니라 서브 셸로도 전달
  - 보통 변수 이름으로 대문자를 사용함
  - 터미널 창을 열어 셸을 시작하면 이미 많은 환경 변수가 설정되어 있음
  - 시스템의 모든 환경 변수의 이름과 값을 출력하려면 `printenv` 명령을 사용
  - `export -p`는 현재 셸의 모든 환경 변수를 출력

- 변수 설정과 환경 변수로 만드는 방법

  - `변수=값; export 변수`
  - 또는 `export 변수=변수`

- 특정 환경 변수의 값을 확인하는 방법

  - `printenv` 변수

  - `echo $변수` 는 지역변수,환경변수 등 모든 변수 값을 확인할 수 있음 

    <img src="./assets/Screenshot 2024-10-09 at 7.42.00 PM.png" alt="Screenshot 2024-10-09 at 7.42.00 PM" style="zoom:50%;" />



### 자주 사용되는 환경 변수

<img src="./assets/Screenshot 2024-10-09 at 7.43.23 PM.png" alt="Screenshot 2024-10-09 at 7.43.23 PM" style="zoom:50%;" />



### 로그인과 셸의 환경 설정 파일

- 로그인 할 때 또는 셸을 시작할 때 자동으로 실행되는 명령을 저장한 파일

  - 시스템 환경 설정 파일과 사용자 환경 설정 파일이 있음
  - 셸의 종류에 따라 다른 이름의 설정 파일을 사용함
  - bash 셸의 경우 다음과 같음
    - 로그인
      - /etc/profile 모든 사용자
      - ~/.bash_profile 개별 사용자

  <img src="./assets/Screenshot 2024-10-09 at 7.44.29 PM.png" alt="Screenshot 2024-10-09 at 7.44.29 PM" style="zoom:50%;" />